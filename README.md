# 🧠 AI Analysis Server

게임 플레이 결과(투표 선택)를 기반으로 AI 분석 결과를 생성하는 **Node.js 기반 AI 분석 서버**입니다.  
OpenAI API를 활용하여 플레이어의 선택 패턴을 해석하고, 정치적·전략적 성향 분석 텍스트를 반환합니다.

> 이 서버는 **게임 메인 서버와 분리된 독립 AI 마이크로서비스**로 동작합니다.

---

## 📌 주요 기능

- 플레이어의 투표 결과(`votes`) 기반 AI 분석
- 시스템 프롬프트 기반 정치·성향 해석
- 개발/테스트용 엔드포인트 제공 (`/analysis/dev`)
- 게임 서버와 분리된 독립 배포 (EC2 + PM2)
- CORS 허용 (프론트엔드 직접 호출 가능)

---

## 🛠 기술 스택

- **Node.js** (ESM)
- **Express**
- **OpenAI API**
- **Supabase** (데이터 조회용)
- **PM2** (프로세스 매니저)
- **AWS EC2 (Ubuntu)**

---

## 📂 프로젝트 구조

```text
AI-analysis/
├─ src/
│  ├─ index.js        # Express 서버 엔트리
│  ├─ analysis.js     # AI 분석 로직
│  ├─ prompt.js       # 시스템 프롬프트 생성
│  ├─ supabase.js     # Supabase client
│  └─ auth.js         # (옵션) 인증 처리
├─ .env               # 환경 변수 (gitignore)
├─ package.json
└─ README.md
```

---

## 🧠 시스템 프롬프트 개요

이 서버는 **고정된 시스템 프롬프트(System Prompt)**를 기반으로  
플레이어의 선택(`votes`)을 해석합니다.

### 프롬프트 설계 목적
- 단순한 점수 계산이 아닌 **서사적·해석적 분석**
- 정치 성향, 가치 판단, 집단 내 위치를 자연어로 설명
- 게임 결과 화면에 바로 출력 가능한 텍스트 생성

### 시스템 프롬프트 예시 (요약)
```text
당신은 정치·사회적 선택을 분석하는 AI 분석가입니다.
플레이어의 투표 기록을 바탕으로 다음을 수행하세요:

1. 전반적인 정치·의사결정 성향 요약
2. 실용주의 vs 원칙주의 경향 분석
3. 다수 의견과의 일치도 해석
4. 게임 세계관에 어울리는 서술적 톤 유지
5. 평가·비난이 아닌 분석과 해석 중심의 문장 생성
